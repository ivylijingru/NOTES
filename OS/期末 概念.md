## 文件系统1
### 关键词
- 文件系统
  - 统一管理**磁盘空间**，实现分配与回收。
  - 实现文件的**按名存取**，名字空间（映射到）磁盘空间。（inode + filename?）
  - 实现文件信息共享，保障安全性。
  - 向用户提供方便使用的接口。
  - 提高文件系统的性能。
  - 提供与 I/O 系统的统一接口。
- 文件：对磁盘的抽象。是一组带标识的，逻辑上有完整意义的信息项（字节）序列。
- 文件分类：按性质和用途分类
  - 普通文件
  - 目录文件：管理文件系统的**系统文件**
  - 特殊文件
- 文件控制块 FCB
  - 存放文件属性或元数据
- 文件目录
  - 统一管理每个文件的信息。所有文件的信息组织在一起，是文件控制块的有序集合。
  - **目录项**是构成文件目录的基本单元。是 **FCB 的子集**。
- 目录文件
  - 将**文件目录**以文件的形式存放在磁盘上。
- 文件系统布局
  - 引导区：从该卷引导操作系统需要的信息。每个分区一个，通常为第一个扇区。
  - 卷（分区）信息：该卷块数、块大小、**空闲块数量和指针**、空闲 FCB 数量和指针
  - 目录结构、用户文件
  - UNIX 文件系统布局：分区结构为 引导记录 | 超级数据块 | 空闲区管理 | I节点区 | 根目录区 | 文件和目录区
  - FAT 文件系统布局：引导区 | 文件分配表 1 | 文件分配表 2 | 根目录 | 其他目录和文件
- 文件逻辑结构
  - 流式文件、记录式文件
  - 存取方式：顺序存取（按字节依次读取）、随机存取（从任意位置读写）。
- 文件物理结构
  - 将存储设备划分为**大小相等的块**，统一编号。以块为单位进行信息的存储、传输、分配。
  - 要考虑的问题：**存储效率**（外部碎片）、**读写性能**（访问速度）
  - 链接结构：文件存放在不连续的物理块中，各块通过指针相连。FAT 中文件分配表，每个表项有三种可能：0（标识空闲块），下一块块号，-1（表示文件结尾）
  - 索引结构：UNIX 采用**多级索引结构**，前12项直接寻址，13项指向一级索引表，14、15二级、三级。
  
| 分配方式 | 优点                                                         | 缺点                                                         |
| -------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 连续结构 | 简单高效，支持顺序存取、随机存取；可以同时读入多个块，检索一个块很容易。 | 文件不能动态增长，需要预留空间。不利于文件内容的插入和删除。有外部碎片问题。 |
| 链接结构 | 提高磁盘空间利用率，没有外部碎片的问题。利于插入、删除以及动态扩充。 | 存取速度慢，不适于随机存取。指针占空间。寻道次数和时间更多。 |
| 索引结构 | 能顺序、随机存取，能够动态增长、插入删除。                   | 较多寻道次数和时间，索引表本身有系统开销。                   |

- 文件描述符/文件句柄
- FAT/UNIX
- 文件基本操作
- 内存结构
- 文件共享
- 磁盘空间管理
### 实现
1. 磁盘上文件系统的布局
2. 文件的物理结构
3. 目录文件的组织方式
4. 文件目录检索
5. 目录文件的改进
